plot(ultra)
ultra <- chronopl(phylo, 0)
# ultra_rooted <- root(ultra, outgroup = NULL, resolve.root = TRUE)
plot(ultra)
ultra <- chronopl(phylo, 0)
ultra_rooted <- root(ultra, outgroup = "B_caccae")
plot(ultra)
ultra <- chronopl(phylo, 0)
ultra_rooted <- root(ultra, outgroup = "B_caccae")
plot(ultra_rooted)
as.dendrogram(ultra_rooted)
ultra <- chronopl(phylo, 0)
ultra_rooted <- root(ultra, outgroup = "B caccae")
ultra <- chronopl(phylo, 0)
ultra_rooted <- root(ultra, outgroup = "B_caccae")
plot(ultra_rooted)
as.dendrogram(ultra_rooted)
ultra <- chronopl(phylo, 0)
ultra_rooted <- root(ultra, outgroup = "R_obeum")
plot(ultra_rooted)
as.dendrogram(ultra_rooted)
ultra <- chronopl(phylo, 0)
ultra_rooted <- root(ultra, outgroup = "B_caccae")
plot(ultra_rooted)
as.dendrogram(ultra_rooted)
as.dendrogram(as-hclust(ultra_rooted))
as.dendrogram(as-hclust(ultra_rooted))
ultra <- chronoa(phylo)
ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "B_caccae")
plot(ultra_rooted)
as.dendrogram(as.hclust(ultra_rooted))
ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "B_caccae")
plot(ultra_rooted)
dl <- dendlist(metdist, metdist)
dl <- dendlist(metdist, metdist)
dl <- dendlist(as.dendrogram(metdist), as.dendrogram(metdist))
dl <- dendlist(as.dendrogram(metdist), as.dendrogram(metdist))
tanglegram(dl)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "B_caccae")
plot(ultra_rooted)
as.dendrogram(as.hclust(ultra_rooted))
as.dendrogram(as.hclust(as.phylo(ultra_rooted)))
as.dendrogram(as.hclust(ultra_rooted))
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "B_caccae", resolve.root=TRUE)
plot(ultra_rooted)
as.dendrogram(as.hclust(ultra_rooted))
as.dendrogram(ultra_rooted)
dl <- dendlist(as.dendrogram(ultra_rooted), as.dendrogram(metdist))
tanglegram(dl)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "B_spiroform", resolve.root=TRUE)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroform", resolve.root=TRUE)
library(tidyverse)
library(ape)
library(phangorn)
library(dendextend)
phylo <- read.tree("10-genomes-phylogeny.tre")
plot(phylo)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
plot(metdist)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroform", resolve.root=TRUE)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
as.dendrogram(ultra_rooted)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
as.dendrogram(ultra_rooted)
dl <- dendlist(as.dendrogram(ultra_rooted), as.dendrogram(metdist))
metdist <- read_table("metdist_KOs.tsv")
metdist <- nj(data.matrix(metdist))
plot(metdist)
phylo <- read.tree("10-genomes-phylogeny.tre")
phylo <- root(phylo, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(phylo)
metdist <- read_table("metdist_KOs.tsv")
metdist <- nj(data.matrix(metdist))
plot(metdist)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
plot(metdist)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
as.dendrogram(ultra_rooted)
dl <- dendlist(as.dendrogram(ultra_rooted), as.dendrogram(metdist))
tanglegram(dl)
library(tidyverse)
library(ape)
library(phangorn)
library(dendextend)
phylo <- read.tree("10-genomes-phylogeny.tre")
phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
plot(phylo)
phylo <- read.tree("10-genomes-phylogeny.tre")
# phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
plot(phylo)
phylo <- read.tree("10-genomes-phylogeny.tre")
phylo <- root(phylo, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(phylo)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
plot(phylo)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
plot(metdist)
as.dendrogram(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
plot(metdist)
as.dendrogram(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
library(tidyverse)
library(ape)
library(phangorn)
library(dendextend)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
library(tidyverse)
library(ape)
library(phangorn)
library(dendextend)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
plot(metdist)
as.dendrogram(ultra_rooted)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
# ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
# plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
# ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
# plot(ultra_rooted)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
# ultra <- chronos(phylo)
ultra <- chronpl(phylo, 0)
phylo <- read.tree("10-genomes-phylogeny.tre")
# ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
# plot(ultra_rooted)
# ultra <- chronos(phylo)
ultra <- chronopl(phylo, 0)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
# ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
# plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
plot(metdist)
as.dendrogram(ultra_rooted)
dl <- dendlist(as.dendrogram(ultra_rooted), as.dendrogram(metdist))
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra_ <- chronos(phylo)
ultra_rooted <- root(ultra_, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra_ <- chronos(phylo)
ultra_rooted <- root(ultra_, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
# ultra_rooted <- root(ultra_, outgroup = "C_spiroforme", resolve.root=TRUE)
ultra_rooted <- root(ultra_, outgroup = "C_spiroforme")
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra_ <- chronos(phylo)
# ultra_rooted <- root(ultra_, outgroup = "C_spiroforme", resolve.root=TRUE)
ultra_rooted <- root(ultra_, outgroup = "C_spiroforme")
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra_ <- chronos(phylo)
# ultra_rooted <- root(ultra_, outgroup = "C_spiroforme", resolve.root=TRUE)
ultra_rooted <- root(ultra_, outgroup = "C_spiroforme")
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
phylo <- root(phylo, outgroup = "C_spiroforme", resolve.root=TRUE)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_spiroforme", resolve.root=TRUE)
plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
plot(ultra_rooted)
dl <- dendlist(as.dendrogram(ultra_rooted), as.dendrogram(metdist))
dl <- dendlist(as.dendrogram(ultra_rooted), as.dendrogram(metdist))
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
plot(metdist)
dl <- dendlist(as.dendrogram(ultra_rooted), as.dendrogram(metdist))
tanglegram(dl)
phylo <- read.tree("10-genomes-phylogeny.tre")
phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
ultra_rooted_dend <- as.dendrogram(ultra_rooted)
plot(ultra_rooted)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
plot(metdist)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
metdist_dend <- as.dendrogram(metdist)
plot(metdist)
dend_intersected <- intersect_trees(ultra_rooted_dend, metdist_dend)
dend_intersected <- intersect_trees(ultra_rooted_dend, metdist_dend)
dend_intersected
Tree1 <- dend_intersected[[1]]
Tree2 <- dend_intersected[[2]]
match_order_by_labels(Tree1, Tree2)
# dl <- dendlist(ultra_rooted_dend, metdist_dend)
# tanglegram(dl)
tanglegram(Tree1, Tree2)
entanglement(Tree1,Tree2)
entanglement(x)
x<-untangle(Tree1,Tree2,method = "ladderize")
entanglement(x)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)))
# phylo <- read.tree("10-genomes-phylogeny.tre")
# phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra_rooted_dend <- as.dendrogram(ultra_rooted)
# plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- multidist2(ultra)
# phylo <- read.tree("10-genomes-phylogeny.tre")
# phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra_rooted_dend <- as.dendrogram(ultra_rooted)
# plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- multidi2(ultra)
# phylo <- read.tree("10-genomes-phylogeny.tre")
# phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra_rooted_dend <- as.dendrogram(ultra_rooted)
# plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- multi2di(ultra)
ultra_rooted_dend <- as.dendrogram(as.hclust.phylo(ultra_rooted))
plot(ultra_rooted)
# phylo <- read.tree("10-genomes-phylogeny.tre")
# phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra_rooted_dend <- as.dendrogram(ultra_rooted)
# plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- multi2di(ultra)
ultra_rooted_dend <- as.dendrogram(as.hclust.phylo(ultra_rooted))
plot(ultra_rooted_dend)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
metdist_dend <- as.dendrogram(metdist)
plot(metdist)
# phylo <- read.tree("10-genomes-phylogeny.tre")
# phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra <- chronos(phylo)
# ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
# ultra_rooted_dend <- as.dendrogram(ultra_rooted)
# plot(ultra_rooted)
phylo <- read.tree("10-genomes-phylogeny.tre")
ultra <- chronos(phylo)
ultra_rooted <- multi2di(ultra)
ultra_rooted_dend <- as.dendrogram(as.hclust.phylo(ultra_rooted))
plot(ultra_rooted)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
metdist_dend <- as.dendrogram(metdist)
plot(metdist)
dend_intersected <- intersect_trees(ultra_rooted_dend, metdist_dend)
dend_intersected
Tree1 <- dend_intersected[[1]]
Tree2 <- dend_intersected[[2]]
match_order_by_labels(Tree1, Tree2)
# dl <- dendlist(ultra_rooted_dend, metdist_dend)
# tanglegram(dl)
tanglegram(Tree1, Tree2)
entanglement(Tree1,Tree2)
x<-untangle(Tree1,Tree2,method = "ladderize")
entanglement(x)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)))
phylo <- read.tree("10-genomes-phylogeny.tre")
phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
ultra_rooted_dend <- as.dendrogram(ultra_rooted)
plot(ultra_rooted)
# phylo <- read.tree("10-genomes-phylogeny.tre")
# ultra <- chronos(phylo)
# ultra_rooted <- multi2di(ultra)
# ultra_rooted_dend <- as.dendrogram(as.hclust.phylo(ultra_rooted))
# plot(ultra_rooted)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
metdist_dend <- as.dendrogram(metdist)
plot(metdist)
dend_intersected <- intersect_trees(ultra_rooted_dend, metdist_dend)
dend_intersected
Tree1 <- dend_intersected[[1]]
Tree2 <- dend_intersected[[2]]
match_order_by_labels(Tree1, Tree2)
# dl <- dendlist(ultra_rooted_dend, metdist_dend)
# tanglegram(dl)
tanglegram(Tree1, Tree2)
entanglement(Tree1,Tree2)
x<-untangle(Tree1,Tree2,method = "ladderize")
entanglement(x)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)))
Tree1 <- dend_intersected[[1]]
Tree2 <- dend_intersected[[2]]
match_order_by_labels(Tree1, Tree2)
Tree1e <- Tree1 %>% set("branches_k_color", k=6) %>% set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
Tree2e <- Tree2 %>% set("branches_k_color", k=6) %>% set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
# dl <- dendlist(ultra_rooted_dend, metdist_dend)
# tanglegram(dl)
tanglegram(Tree1e, Tree2e, common_subtrees_color_branches = TRUE, k_labels=6, lwd = 1)
entanglement(Tree1,Tree2)
x<-untangle(Tree1,Tree2,method = "ladderize")
entanglement(x)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)))
entanglement(Tree1e,Tree2e)
x<-untangle(Tree1e,Tree2e,method = "ladderize")
entanglement(x)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)))
# dl <- dendlist(ultra_rooted_dend, metdist_dend)
# tanglegram(dl)
tanglegram(Tree1e, Tree2e, sort = TRUE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE)
# Tree1e <- Tree1 %>% set("branches_k_color", k=6) %>% set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
# Tree2e <- Tree2 %>% set("branches_k_color", k=6) %>% set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
Tree1e <- Tree1 %>%  set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
Tree2e <- Tree2 %>% set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
# dl <- dendlist(ultra_rooted_dend, metdist_dend)
# tanglegram(dl)
tanglegram(Tree1e, Tree2e, sort = TRUE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE)
entanglement(Tree1e,Tree2e)
x<-untangle(Tree1e,Tree2e,method = "ladderize")
entanglement(x)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)))
# dl <- dendlist(ultra_rooted_dend, metdist_dend)
# tanglegram(dl)
tanglegram(Tree1e, Tree2e, sort = TRUE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE)
entanglement(Tree1e,Tree2e)
x<-untangle(Tree1e,Tree2e,method = "ladderize")
entanglement(x)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)))
entanglement(Tree1e,Tree2e)
x<-untangle(Tree1e,Tree2e,method = "ladderize")
entanglement(x)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)))
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = TRUE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = TRUE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = TRUE, highlight_branches_lwd = FALSE)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = TRUE, common_subtrees_color_lines = TRUE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = TRUE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=5)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=1)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = TRUE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = TRUE, common_subtrees_color_lines = TRUE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, columns_width=c(6,2,6))
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, columns_width=c(5,3,5))
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, lab.cex=2)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, lab.cex=1)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, lab.cex=1.2)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2)
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, lab.cex=1.2)
svg("tanglegram.svg")
x %>% plot(main = paste("entanglement =", round(entanglement(x), 1)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, lab.cex=1.2)
dev.off()
svg("tanglegram.svg")
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, lab.cex=1.2)
dev.off()
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, lab.cex=1.2)
library(tidyverse)
library(ape)
library(phangorn)
library(dendextend)
phylo <- read.tree("10-genomes-phylogeny.tre")
phylo <- root(phylo, outgroup = "C_aerofaciens", resolve.root=TRUE)
ultra <- chronos(phylo)
ultra_rooted <- root(ultra, outgroup = "C_aerofaciens", resolve.root=TRUE)
ultra_rooted_dend <- as.dendrogram(ultra_rooted)
plot(ultra_rooted)
# phylo <- read.tree("10-genomes-phylogeny.tre")
# ultra <- chronos(phylo)
# ultra_rooted <- multi2di(ultra)
# ultra_rooted_dend <- as.dendrogram(as.hclust.phylo(ultra_rooted))
# plot(ultra_rooted)
metdist <- read_table("metdist_KOs.tsv")
metdist <- upgma(data.matrix(metdist))
metdist_dend <- as.dendrogram(metdist)
plot(metdist)
dend_intersected <- intersect_trees(ultra_rooted_dend, metdist_dend)
dend_intersected
Tree1 <- dend_intersected[[1]]
Tree2 <- dend_intersected[[2]]
match_order_by_labels(Tree1, Tree2)
# Tree1e <- Tree1 %>% set("branches_k_color", k=6) %>% set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
# Tree2e <- Tree2 %>% set("branches_k_color", k=6) %>% set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
Tree1e <- Tree1 %>%  set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
Tree2e <- Tree2 %>% set("branches_lwd", 1.5) %>% set("labels_cex", 0.5)
# dl <- dendlist(ultra_rooted_dend, metdist_dend)
# tanglegram(dl)
tanglegram(Tree1e, Tree2e, sort = TRUE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE)
entanglement(Tree1e,Tree2e)
x<-untangle(Tree1e,Tree2e,method = "ladderize")
entanglement(x)
svg("tanglegram.svg")
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = FALSE, highlight_branches_lwd = FALSE, lwd=2, lab.cex=1.2)
dev.off()
x %>% plot(main = paste("entanglement =", round(entanglement(x), 2)),sort = FALSE, common_subtrees_color_lines = FALSE, highlight_distinct_edges  = TRUE, highlight_branches_lwd = FALSE, lwd=2, lab.cex=1.2)
